# ==============================================================================
# PixEagle Configuration File - v2.0
# ==============================================================================
# üìã Priority parameters are at the top for quick access
# üîß All legacy parameters preserved (deprecated ones marked in comments)
# üìò Enhanced documentation for each parameter
# ==============================================================================

# ==============================================================================
# PRIMARY VIDEO INPUT CONFIGURATION (Top Priority)
# ==============================================================================
VideoSource:
  # Primary video source selection
  # Options: VIDEO_FILE, USB_CAMERA, RTSP_OPENCV, RTSP_GSTREAMER, UDP_STREAM, HTTP_STREAM, CSI_CAMERA, CUSTOM_GSTREAMER
  VIDEO_SOURCE_TYPE: USB_CAMERA
  
  # === Universal Capture Parameters (Applied to ALL sources) ===
  # üîß These ensure consistent processing regardless of input type
  CAPTURE_WIDTH: 640          # Width in pixels (lower = less CPU)
  CAPTURE_HEIGHT: 480         # Height in pixels 
  CAPTURE_FPS: 30            # Target FPS (actual may vary by source)
  DEFAULT_FPS: 30            # Fallback if source doesn't report FPS
  
  # === Performance Optimization ===
  # üöÄ Enable for Raspberry Pi, Jetson, or low-power systems
  USE_GSTREAMER: false       # true = Use GStreamer pipelines (better for embedded)
  
  # === Source-Specific Parameters ===
  # Video file source
  VIDEO_FILE_PATH: resources/test4.mp4
  
  # USB Camera (webcam)
  CAMERA_INDEX: 0            # 0=first camera, 1=second, etc.
  
  # Network streams
  RTSP_URL: rtsp://192.168.0.108:554/stream=0
  RTSP_LATENCY: 0           # Buffer in ms (0=minimum latency, 200=stable)
  UDP_URL: udp://172.21.144.1:5000
  HTTP_URL: http://172.21.144.1:8100
  
  # CSI Camera (Raspberry Pi/Jetson camera)
  CSI_SENSOR_ID: 0          # Usually 0 for first CSI port
  
  # Custom GStreamer pipeline (advanced users)
  # Example: "videotestsrc ! video/x-raw,width=640,height=480 ! videoconvert ! appsink"
  CUSTOM_PIPELINE: ""
  
  # === Legacy Parameters (kept for compatibility) ===
  # DEPRECATED: Use CAPTURE_WIDTH/HEIGHT instead of CSI_WIDTH/HEIGHT
  STORE_LAST_FRAMES: 5      # Frame history buffer size

# ==============================================================================
# USB CAMERA OPTIMIZATION
# ==============================================================================
USBCamera:
  # Device path for Linux GStreamer (ignored on Windows)
  DEVICE_PATH: /dev/video0
  
  # Pixel format selection (impacts CPU usage)
  # YUYV = uncompressed (moderate CPU)
  # MJPG = compressed (lowest CPU, recommended for RPi)
  PIXEL_FORMAT: YUYV
  
  # OpenCV backend optimizations (when USE_GSTREAMER=false)
  USE_V4L2_BACKEND: false    # Linux only: direct V4L2 access
  OPENCV_BUFFER_SIZE: 1      # 1=lowest latency, 3=smoother
  OPENCV_FOURCC: ""          # Force codec: "MJPG", "H264", etc.

# ==============================================================================
# CSI CAMERA CONFIGURATION (Raspberry Pi/Jetson)
# ==============================================================================
Camera:  # Legacy name kept for compatibility
  # CSI-specific settings
  CSI_WIDTH: 640            # DEPRECATED: Use CAPTURE_WIDTH in VideoSource
  CSI_HEIGHT: 480           # DEPRECATED: Use CAPTURE_HEIGHT in VideoSource
  CSI_FRAMERATE: 30         # DEPRECATED: Use CAPTURE_FPS in VideoSource
  CSI_FLIP_METHOD: 0        # 0=none, 1=90¬∞CW, 2=180¬∞, 3=90¬∞CCW, 4=horizontal, 5=vertical

CSICamera:  # New section name (preferred)
  SENSOR_ID: 0              # Camera sensor ID
  FLIP_METHOD: 0            # Image rotation/flip

# ==============================================================================
# NETWORK CONFIGURATION (Connection Settings)
# ==============================================================================
PX4:
  # üöÅ PX4 Autopilot connection via MAVSDK
  EXTERNAL_MAVSDK_SERVER: true
  # For SITL: udp://127.0.0.1:14540
  # For companion computer: udp://127.0.0.1:14540  
  # For WSL: udp://172.21.148.30:14540 (use your WSL IP)
  SYSTEM_ADDRESS: udp://127.0.0.1:14540

MAVLink:
  # üì° MAVLink telemetry data source (MAVLink2REST)
  MAVLINK_ENABLED: true
  # For local: 127.0.0.1
  # For WSL: 172.21.148.30 (your WSL IP)
  MAVLINK_HOST: 127.0.0.1
  MAVLINK_PORT: 8088
  MAVLINK_POLLING_INTERVAL: 0.5    # Data refresh rate in seconds
  
  # Data points to fetch from MAVLink2REST API
  MAVLINK_DATA_POINTS:
    latitude: /vehicles/1/components/1/messages/GLOBAL_POSITION_INT/message/lat
    longitude: /vehicles/1/components/1/messages/GLOBAL_POSITION_INT/message/lon
    altitude_msl: /vehicles/1/components/1/messages/ALTITUDE/message/altitude_amsl
    altitude_agl: /vehicles/1/components/1/messages/ALTITUDE/message/altitude_relative
    voltage: /vehicles/1/components/1/messages/SYS_STATUS/message/voltage_battery
    airspeed: /vehicles/1/components/1/messages/VFR_HUD/message/airspeed
    throttle: /vehicles/1/components/1/messages/VFR_HUD/message/throttle
    groundspeed: /vehicles/1/components/1/messages/VFR_HUD/message/groundspeed
    climb: /vehicles/1/components/1/messages/VFR_HUD/message/climb
    vn: /vehicles/1/components/1/messages/LOCAL_POSITION_NED/message/vx
    ve: /vehicles/1/components/1/messages/LOCAL_POSITION_NED/message/vy
    vd: /vehicles/1/components/1/messages/LOCAL_POSITION_NED/message/vz
    flight_path_angle: null
    roll: /vehicles/1/components/1/messages/ATTITUDE/message/roll
    pitch: /vehicles/1/components/1/messages/ATTITUDE/message/pitch
    heading: /vehicles/1/components/1/messages/VFR_HUD/message/heading
    vdop: /vehicles/1/components/1/messages/GPS_RAW_INT/message/vdop
    hdop: /vehicles/1/components/1/messages/GPS_RAW_INT/message/hdop
    satellites_visible: /vehicles/1/components/1/messages/GPS_RAW_INT/message/satellites_visible
    flight_mode: /vehicles/1/components/1/messages/HEARTBEAT/message/custom_mode
    arm_status: /vehicles/1/components/1/messages/HEARTBEAT/message/base_mode


# ==============================================================================
# VIDEO STREAMING OUTPUT (Dashboard/Client) - ENHANCED
# ==============================================================================
Streaming:
  # üñ•Ô∏è Enable HTTP/WebSocket video streaming to web dashboard
  ENABLE_STREAMING: true
  
  # === Server Settings ===
  HTTP_STREAM_HOST: 0.0.0.0      # 0.0.0.0 = all interfaces
  HTTP_STREAM_PORT: 5077          # Web dashboard port
  
  # === Stream Quality Settings ===
  STREAM_WIDTH: 640               # Output resolution
  STREAM_HEIGHT: 480              
  STREAM_FPS: 10                  # Target FPS (actual may vary)
  STREAM_QUALITY: 60              # Default JPEG quality (0-100)
  STREAM_PROCESSED_OSD: true      # Include overlays
  
  
  # === Frame Buffering ===
  ENABLE_FRAME_CACHE: true        # Cache encoded frames
  CACHE_TTL_MS: 100              # Cache time-to-live in ms
  MAX_FRAME_QUEUE: 3             # Max queued frames per client
  
  # === WebSocket Settings ===
  WS_MAX_CONNECTIONS: 10         # Max concurrent WebSocket clients
  WS_ENABLE_COMPRESSION: false   # Enable WebSocket compression
  

   # Adaptive Quality Control
  ENABLE_ADAPTIVE_QUALITY: true    # Set true for auto quality adjustment
  MIN_QUALITY: 30                   # Minimum JPEG quality (1-100)
  MAX_QUALITY: 85                   # Maximum JPEG quality (1-100)
  QUALITY_STEP: 10                  # Quality adjustment step size
  
  # Frame Caching (reduces CPU usage)
  ENABLE_FRAME_CACHE: true         # Set true to cache encoded frames
  CACHE_TTL_MS: 100                # Cache time-to-live in milliseconds
  SKIP_IDENTICAL_FRAMES: true     # Skip encoding if frame unchanged
  
  # Connection Limits
  HTTP_MAX_CONNECTIONS: 20         # Max concurrent HTTP streams
  WS_MAX_CONNECTIONS: 10           # Max concurrent WebSocket clients
  MAX_FRAME_QUEUE: 3               # Max queued frames per WebSocket client
  HTTP_CHUNK_SIZE: 65536         # Chunk size for streaming

  
  # === Performance ===
  ENCODING_THREADS: 2            # Parallel encoding threads
  ENABLE_HARDWARE_ENCODING: false # Use hardware encoder if available
  SKIP_IDENTICAL_FRAMES: true    # Skip encoding if frame unchanged
  FRAME_DIFFERENCE_THRESHOLD: 5  # Pixel difference threshold
  
  # === H.264 Streaming (Advanced) ===
  ENABLE_H264_STREAM: false      # Enable H.264/WebRTC streaming
  H264_BITRATE: 1000000          # H.264 bitrate (bps)
  H264_PROFILE: baseline         # H.264 profile (baseline/main/high)
  H264_PRESET: ultrafast         # Encoding preset

# ==============================================================================
# TRACKING MODE CONFIGURATION
# ==============================================================================
Tracking:
  # üéØ Classic tracker algorithm selection
  # Options: CSRT (accurate), KCF (fast), MOSSE (fastest), ParticleFilter (robust)
  DEFAULT_TRACKING_ALGORITHM: CSRT
  
  # === Visualization ===
  TRACKING_RECTANGLE_COLOR: [255, 0, 0]    # BGR: Blue
  CENTER_CIRCLE_COLOR: [0, 255, 0]         # BGR: Green
  CENTER_HISTORY_LENGTH: 10                # Trail length
  
  # === Tracking Quality Control ===
  MAX_DISPLACEMENT_THRESHOLD: 0.25         # Max jump as fraction of frame
  TRACKING_FAILURE_TIMEOUT: 5.0            # Seconds before re-detection
  CONFIDENCE_THRESHOLD: 0.6                # Min confidence to accept result
  
  # === CSRT Parameters ===
  CSRT_APPEARANCE_LEARNING_RATE: 0.05      # Adaptation speed
  
  # === Appearance Model ===
  APPEARANCE_THRESHOLD: 0.3                # Similarity threshold (0-1)
  APPEARANCE_CONFIDENCE_THRESHOLD: 0.5     
  MOTION_CONFIDENCE_WEIGHT: 0.5            # Balance motion vs appearance
  APPEARANCE_CONFIDENCE_WEIGHT: 0.5
  
  # === Re-detection ===
  REDETECTION_ATTEMPTS: 5                  # Max attempts before giving up
  
  # === Particle Filter Parameters (if using) ===
  PF_NUM_PARTICLES: 500                    # More = accurate but slower
  PF_INIT_POS_STD: 20.0                   # Initial position uncertainty
  PF_INIT_VEL_STD: 5.0                    # Initial velocity uncertainty
  PF_INIT_ACC_STD: 1.0                    # Initial acceleration uncertainty
  PF_POS_STD: 15.0                        # Process noise for position
  PF_VEL_STD: 5.0                         # Process noise for velocity
  PF_ACC_STD: 1.0                         # Process noise for acceleration
  PF_APPEARANCE_LIKELIHOOD_SCALE: 25.0    
  PF_APPEARANCE_LEARNING_RATE: 0.05       
  PF_COLOR_WEIGHT: 0.7                    # Color vs edge importance
  PF_EDGE_WEIGHT: 0.3
  PF_CANNY_THRESHOLD1: 50                 # Edge detection params
  PF_CANNY_THRESHOLD2: 150
  PF_EFFECTIVE_PARTICLE_NUM_THRESHOLD: 0.5 
  PF_RANDOM_PARTICLE_RATIO: 0.1           # Random resampling ratio

# ==============================================================================
# SMART TRACKER (YOLO-based AI Tracking)
# ==============================================================================
SmartTracker:
  # ü§ñ Enable AI-powered object tracking
  SMART_TRACKER_ENABLED: true
  
  # === Hardware Selection ===
  SMART_TRACKER_USE_GPU: true              # Try GPU first (CUDA)
  SMART_TRACKER_FALLBACK_TO_CPU: true      # Fall back if GPU fails
  
  # === Model Paths ===
  # üìÅ Use add_yolo_model.py to download/convert models
  SMART_TRACKER_GPU_MODEL_PATH: "yolo/yolo11n.pt"          # PyTorch model
  SMART_TRACKER_CPU_MODEL_PATH: "yolo/yolo11n_ncnn_model"  # Optimized for ARM
  
  # === Detection Parameters ===
  SMART_TRACKER_CONFIDENCE_THRESHOLD: 0.3   # Min detection confidence
  SMART_TRACKER_IOU_THRESHOLD: 0.3          # Overlap threshold
  SMART_TRACKER_MAX_DETECTIONS: 20          # Max objects per frame
  
  # === Tracker Settings ===
  SMART_TRACKER_TRACKER_TYPE: "bytetrack.yaml"
  SMART_TRACKER_COLOR: [0, 255, 255]        # BGR: Yellow
  SMART_TRACKER_SHOW_FPS: false

# ==============================================================================
# FOLLOWER MODE (Drone Following Behavior)
# ==============================================================================
Follower:
  # === Interface Settings ===
  USE_MAVLINK2REST: true                    # Use REST API for MAVLink
  FOLLOWER_DATA_REFRESH_RATE: 5             # Hz
  
  # === Target Selection ===
  ROI_SELECTION_MODE: MANUAL                # MANUAL or AUTO
  TARGET_POSITION_MODE: center              # center, top, bottom
  
  # === Following Mode ===
  # Options: ground_view, constant_distance, constant_position, chase_follower
  FOLLOWER_MODE: chase_follower
  
  # === Control Features ===
  ENABLE_ALTITUDE_CONTROL: true             # Follow target altitude changes
  
  # === Visualization ===
  SHOW_TRACKING_WINDOW: false               # Debug window
  DISPLAY_DEVIATIONS: false                 # Show error vectors
  TRACKED_BBOX_STYLE: fancy                 # simple or fancy
  FOLLOWER_ACTIVE_COLOR: [0, 0, 255]       # BGR: Red when active
  FOLLOWER_INACTIVE_COLOR: [0, 255, 255]   # BGR: Yellow when inactive
  BBOX_LINE_THICKNESS: 2
  EXTENDED_LINE_THICKNESS: 2
  CORNER_DOT_RADIUS: 4
  CROSSHAIR_ARM_LENGTH: 20
  BBOX_CORNER_ARM_LENGTH: 20
  OVERLAY_OPACITY: 128

# ==============================================================================
# DETECTOR CONFIGURATION
# ==============================================================================
Detector:
  # üîç Object detection for tracker initialization/recovery
  USE_DETECTOR: true
  DETECTION_ALGORITHM: TemplateMatching     # or FeatureMatching, YOLO
  
  # === Template Matching ===
  TEMPLATE_MATCHING_METHOD: TM_CCOEFF_NORMED
  TEMPLATE_UPDATE_INTERVAL: 10              # Frames between updates
  TEMPLATE_APPEARANCE_LEARNING_RATE: 0.002
  TEMPLATE_MATCHING_SCALES: [0.95, 1.0, 1.05]  # Multi-scale search
  TEMPLATE_MATCHING_THRESHOLD: 0.8
  APPEARANCE_CONFIDENCE_THRESHOLD: 0.7
  TRACKER_CONFIDENCE_THRESHOLD_FOR_TEMPLATE_UPDATE: 0.8
  
  # === Feature Matching ===
  DEFAULT_FEATURE_EXTRACTION_ALGORITHM: ORB  # or SIFT, SURF
  ORB_NFEATURES: 500
  ORB_MIN_MATCH_COUNT: 30
  RANSAC_REPROJECTION_THRESHOLD: 10.0
  
  # === Re-detection Parameters ===
  AUTO_REDETECT: true
  REDETECTION_SEARCH_RADIUS: 300            # Pixels
  MIN_SEARCH_RADIUS: 50
  UNCERTAINTY_SCALE_FACTOR: 2.0
  ESTIMATOR_UNCERTAINTY_THRESHOLD: 1000.0

# ==============================================================================
# GSTREAMER PIPELINE TEMPLATES
# ==============================================================================
# üîß Advanced users can edit these templates
# Variables: {width}, {height}, {fps}, {device_id}, {url}, {latency}
GStreamerPipelines:
  # USB camera pipelines
  USB_YUYV: "v4l2src device=/dev/video{device_id} ! video/x-raw,format=YUY2,width={width},height={height},framerate={fps}/1 ! videoconvert ! video/x-raw,format=BGR ! appsink drop=true max-buffers=1 sync=false"
  
  USB_MJPEG: "v4l2src device=/dev/video{device_id} ! image/jpeg,width={width},height={height},framerate={fps}/1 ! jpegdec ! videoconvert ! video/x-raw,format=BGR ! appsink drop=true max-buffers=1 sync=false"
  
  # CSI camera pipelines
  CSI_NVIDIA: "nvarguscamerasrc sensor-id={sensor_id} ! video/x-raw(memory:NVMM),width={width},height={height},format=NV12,framerate={fps}/1 ! nvvidconv flip-method={flip_method} ! video/x-raw,format=BGRx ! videoconvert ! video/x-raw,format=BGR ! appsink drop=true sync=false"
  
  CSI_RPI: "libcamerasrc ! video/x-raw,width={width},height={height},framerate={fps}/1 ! videoconvert ! video/x-raw,format=BGR ! appsink drop=true sync=false"
  
  # Network stream pipelines
  RTSP: "rtspsrc location={url} latency={latency} ! decodebin ! videoconvert ! video/x-raw,format=BGR ! videoscale ! video/x-raw,width={width},height={height} ! appsink drop=true sync=false"
  
  UDP: "udpsrc uri={url} ! application/x-rtp ! rtph264depay ! avdec_h264 ! videoconvert ! video/x-raw,format=BGR ! videoscale ! video/x-raw,width={width},height={height} ! appsink drop=true sync=false"
  
  HTTP: "souphttpsrc location={url} ! decodebin ! videoconvert ! video/x-raw,format=BGR ! videoscale ! video/x-raw,width={width},height={height} ! appsink drop=true sync=false"

# ==============================================================================
# FRAME WINDOW & DISPLAY
# ==============================================================================
FrameEstimation:
  # üñºÔ∏è Video display window settings
  FRAME_TITLE: Video                        # Window title
  DEFAULT_FPS: 30                           # DEPRECATED: Use VideoSource/DEFAULT_FPS
  SHOW_VIDEO_WINDOW: false                  # true for debugging with display

# ==============================================================================
# ESTIMATOR (Kalman Filter for Tracking)
# ==============================================================================
Estimator:
  # üìä State estimation for smooth tracking
  USE_ESTIMATOR: true
  ESTIMATOR_TYPE: Kalman                    # Options: Kalman, None
  ESTIMATOR_ENABLED: true                   # DEPRECATED: Use USE_ESTIMATOR
  ESTIMATOR_HISTORY_LENGTH: 5               # State history buffer
  
  # === Kalman Filter Parameters ===
  ESTIMATOR_PROCESS_NOISE_VARIANCE: 10.0    # Motion uncertainty
  ESTIMATOR_MEASUREMENT_NOISE_VARIANCE: 1.0 # Sensor noise
  # Initial covariance: [x, y, dx, dy, ddx, ddy]
  ESTIMATOR_INITIAL_STATE_COVARIANCE: [5, 5, 50, 50, 100, 100]
  
  # === Usage ===
  USE_ESTIMATOR_FOR_FOLLOWING: true         # Use predictions for control
  
  # === Visualization ===
  ESTIMATED_POSITION_COLOR: [255, 0, 0]     # Blue: tracking active
  ESTIMATION_ONLY_COLOR: [0, 165, 255]      # Orange: prediction only

# ==============================================================================
# FRAME PREPROCESSING
# ==============================================================================
FramePreprocessor:
  # üé® Image enhancement for better tracking
  ENABLE_PREPROCESSING: true
  
  # === Blur (noise reduction) ===
  PREPROCESSING_USE_BLUR: true
  PREPROCESSING_BLUR_KERNEL_SIZE: 5         # Must be odd (3, 5, 7...)
  PREPROCESSING_USE_MEDIAN_BLUR: false
  PREPROCESSING_MEDIAN_BLUR_KERNEL_SIZE: 5
  
  # === Contrast Enhancement ===
  PREPROCESSING_USE_CLAHE: true             # Adaptive histogram equalization
  PREPROCESSING_CLAHE_CLIP_LIMIT: 2.0       # Contrast limit
  PREPROCESSING_CLAHE_TILE_GRID_SIZE: 8     # Grid size (1-10)
  
  # === Color Space ===
  PREPROCESSING_COLOR_SPACE: BGR            # Options: BGR, GRAY, HSV, LAB

# ==============================================================================
# SEGMENTATION
# ==============================================================================
Segmentation:
  # üé≠ Object segmentation for precise tracking
  SEGMENTATION_ALGORITHMS: ['GrabCut', 'Watershed', 'yolov8s-seg', 'yolov8n-oiv7', 'yolov8s-obb','yolov11n']
  DEFAULT_SEGMENTATION_ALGORITHM: yolov11n.pt
  USE_SEGMENTATION_FOR_TRACKING: true
  
  # === Morphological Operations ===
  MORPHOLOGICAL_KERNEL_SIZE: 5
  DILATION_ITERATIONS: 2
  EROSION_ITERATIONS: 1
  
  # === GrabCut Parameters ===
  SEGMENTATION_GRABCUT_ITER: 5
  SEGMENTATION_MIN_AREA: 500                # Min segment area in pixels

# ==============================================================================
# YAW CONTROL
# ==============================================================================
YawControl:
  # üîÑ Drone yaw (heading) control
  ENABLE_YAW_CONTROL: false
  YAW_CONTROL_THRESHOLD: 0.3                # Activation threshold
  YAW_LATERAL_BLEND_FACTOR: 0.5             # Blend yaw with lateral motion
  YAW_DEAD_ZONE: 0.2                        # Ignore small errors

# ==============================================================================
# VERTICAL ERROR RECALCULATION
# ==============================================================================
VerticalErrorRecalculation:
  # üìê Altitude control parameters
  VERTICAL_RECALC_DELAY: 0.1                # Seconds
  YAW_PITCH_SYNC_FACTOR: 0.5                # Coupling factor

# ==============================================================================
# GIMBAL CONTROL
# ==============================================================================
Gimbal:
  # üì∑ Camera gimbal settings
  ENABLE_GIMBAL_PRIORITY: true              # Gimbal overrides body motion

# ==============================================================================
# ADAPTIVE CONTROL
# ==============================================================================
AdaptiveControl:
  # üîß Adaptive control features
  ADAPTIVE_YAW_CONTROL: false               # Auto-tune yaw gains

# ==============================================================================
# CHASE FOLLOWER LIMITS
# ==============================================================================
ChaseFollower:
  # üöÅ Safety limits for chase mode
  MAX_ROLL_RATE: 20.0                      # deg/s
  MAX_PITCH_RATE: 10.0                     # deg/s
  MAX_YAW_RATE: 10.0                       # deg/s
  MAX_THRUST: 1.0                          # 0-1
  MIN_THRUST: 0.3                          # 0-1
  MIN_GROUND_SPEED: 0                      # m/s
  MAX_GROUND_SPEED: 100                    # m/s
  TARGET_SPEED: 60                         # m/s
  MAX_BANK_ANGLE: 20                       # degrees
  YAW_ERROR_CHECK_ENABLED: true
  YAW_ERROR_THRESHOLD: 20                  # degrees
  ALTITUDE_FAILSAFE_ENABLED: false

# ==============================================================================
# PID CONTROLLER
# ==============================================================================
PID:
  # ‚öôÔ∏è PID gains for each control axis
  PID_GAINS:
    x: {p: 4.5, i: 0.1, d: 1.5}            # Lateral
    y: {p: 4.5, i: 0.1, d: 1.5}            # Longitudinal  
    z: {p: 2, i: 0.03, d: 0.05}            # Vertical
    roll_rate: {p: 1, i: 0.05, d: 0.2}
    pitch_rate: {p: 20, i: 0.1, d: 0.4}
    yaw_rate: {p: 2.7, i: 0.1, d: 0.01}
    thrust: {p: 0.1, i: 3, d: 1}
  
  # === Advanced PID Features ===
  PROPORTIONAL_ON_MEASUREMENT: false        # Avoid derivative kick
  ENABLE_ANTI_WINDUP: true                  # Prevent integral windup
  ANTI_WINDUP_BACK_CALC_COEFF: 0.1         # Back-calculation coefficient

# ==============================================================================
# VELOCITY & SAFETY LIMITS
# ==============================================================================
VelocityDescent:
  # üõ°Ô∏è Safety limits and control parameters
  VELOCITY_LIMITS:
    x: 10.0                                 # Max lateral velocity (m/s)
    y: 10.0                                 # Max longitudinal velocity (m/s)
    z: 5.0                                  # Max vertical velocity (m/s)
  
  # === Altitude Control ===
  ENABLE_DESCEND_TO_TARGET: false          # Follow target down
  MIN_DESCENT_HEIGHT: 40                   # Min altitude (m)
  MAX_CLIMB_HEIGHT: 10000                  # Max altitude (m)
  MAX_RATE_OF_DESCENT: 2                   # m/s
  
  # === Yaw Control ===
  MAX_YAW_RATE: 10                         # deg/s
  
  # === Camera Aiming ===
  DESIRE_AIM: [0, 0]                       # Desired aim point in frame
  IS_CAMERA_GIMBALED: false                # Fixed vs gimbal camera
  
  # === Control Scaling ===
  BASE_ADJUSTMENT_FACTOR_X: 0.1
  BASE_ADJUSTMENT_FACTOR_Y: 0.1
  ALTITUDE_FACTOR: 0.005                   # Scale with altitude

# ==============================================================================
# GAIN SCHEDULING
# ==============================================================================
GainScheduling:
  # üìà Altitude-based gain adjustment
  ENABLE_GAIN_SCHEDULING: false
  GAIN_SCHEDULING_PARAMETER: current_altitude
  
  # Altitude ranges and corresponding gains
  ALTITUDE_GAIN_SCHEDULE:
    '(0, 20)':      # 0-20m altitude
      x: {p: 5.5, i: 0.2, d: 0.4}
      y: {p: 5.5, i: 0.2, d: 0.4}
      z: {p: 1, i: 0.01, d: 0.1}
    '(20, 50)':     # 20-50m altitude
      x: {p: 6, i: 0.25, d: 0.5}
      y: {p: 6, i: 0.25, d: 0.5}
      z: {p: 1, i: 0.015, d: 0.15}
    '(50, 100)':    # 50-100m altitude
      x: {p: 6.5, i: 0.3, d: 0.6}
      y: {p: 6.5, i: 0.3, d: 0.6}
      z: {p: 1, i: 0.02, d: 0.2}
    '(100, 150)':   # 100-150m altitude
      x: {p: 6, i: 0.3, d: 1.0}
      y: {p: 6, i: 0.3, d: 1.0}
      z: {p: 1, i: 0.01, d: 0.01}
    '(150, 200)':   # 150-200m altitude
      x: {p: 5.5, i: 0.25, d: 0.8}
      y: {p: 5.5, i: 0.25, d: 0.8}
      z: {p: 1, i: 0.01, d: 0.05}

# ==============================================================================
# SETPOINT CONTROL
# ==============================================================================
Setpoint:
  # üìç Position/velocity setpoint configuration
  CAMERA_YAW_OFFSET: 0                     # Camera mounting offset (degrees)
  SETPOINT_PUBLISH_RATE_S: 0.1             # Setpoint update period (seconds)
  ENABLE_SETPOINT_DEBUGGING: false         # Debug output

# ==============================================================================
# TELEMETRY
# ==============================================================================
Telemetry:
  # üìä Telemetry data distribution
  ENABLE_TELEMETRY: true
  TELEMETRY_SEND_RATE: 2                   # Hz
  TELEMETRY_FLASK_ENDPOINT: /telemetry     # REST endpoint
  
  # === UDP Telemetry ===
  ENABLE_UDP_STREAM: false
  UDP_HOST: 127.0.0.1
  UDP_PORT: 5550
  
  # === WebSocket Telemetry ===
  WEBSOCK_HOST: 127.0.0.1
  WEBSOCK_PORT: 5551
  
  # === Data Selection ===
  ENABLE_FOLLOWER_TELEMETRY: true          # Include follower status

# ==============================================================================
# GSTREAMER OUTPUT STREAM (Secondary Output)
# ==============================================================================
GStreamer:
  # üìπ Optional GStreamer pipeline for external streaming
  ENABLE_GSTREAMER_STREAM: false
  GSTREAMER_HOST: 127.0.0.1
  GSTREAMER_PORT: 2000
  GSTREAMER_BITRATE: 2000                  # kbps
  GSTREAMER_WIDTH: 1280
  GSTREAMER_HEIGHT: 720
  GSTREAMER_FRAMERATE: 15
  GSTREAMER_BUFFER_SIZE: 50000000          # bytes
  GSTREAMER_SPEED_PRESET: ultrafast        # x264 preset
  GSTREAMER_KEY_INT_MAX: 30                # Keyframe interval
  GSTREAMER_TUNE: zerolatency               # x264 tuning
  
  # === Video Enhancement ===
  GSTREAMER_CONTRAST: 5.0
  GSTREAMER_BRIGHTNESS: 10
  GSTREAMER_SATURATION: 5

# ==============================================================================
# OSD (ON-SCREEN DISPLAY)
# ==============================================================================
OSD:
  # üì∫ Video overlay configuration
  OSD_ENABLED: true
  
  OSD_CONFIG:
    # === Title/Watermark ===
    name:
      enabled: true
      text: PixEagle
      position: [3, 5]                     # % from top-left
      color: [255, 255, 255]               # BGR: White
      font_size: 0.7
    
    # === Timestamp ===
    datetime:
      enabled: true
      position: [98, 5]                    # % from top-left
      color: [255, 255, 255]
      font_size: 0.6
      alignment: right
    
    # === Crosshair ===
    crosshair:
      enabled: true
      color: [0, 255, 0]                   # BGR: Green
      thickness: 2
      length: 15
    
    # === Attitude Indicator (Artificial Horizon) ===
    attitude_indicator:
      enabled: true
      position: [50, 50]                   # Center position
      size: [70, 70]                       # Width, height
      horizon_color: [255, 255, 255]
      grid_color: [200, 200, 200]
      thickness: 2
    
    # === MAVLink Telemetry Data ===
    mavlink_data:
      enabled: true
      fields:
        # Navigation data
        heading:
          position: [45, 30]
          font_size: 0.5
          color: [255, 255, 255]
        airspeed:
          position: [10, 45]
          font_size: 0.4
          color: [255, 255, 255]
        groundspeed:
          position: [10, 55]
          font_size: 0.4
          color: [255, 255, 255]
        throttle:
          position: [10, 65]
          font_size: 0.3
          color: [255, 255, 255]
        
        # Altitude data
        altitude_msl:
          position: [65, 45]
          font_size: 0.4
          color: [255, 255, 255]
        altitude_agl:
          position: [65, 55]
          font_size: 0.4
          color: [255, 255, 255]
        flight_path_angle:
          position: [65, 65]
          font_size: 0.4
          color: [255, 255, 255]
        
        # Attitude
        roll:
          position: [45, 75]
          font_size: 0.5
          color: [255, 255, 255]
        pitch:
          position: [45, 80]
          font_size: 0.5
          color: [255, 255, 255]
        
        # GPS data
        latitude:
          position: [2, 92]
          font_size: 0.3
          color: [255, 255, 255]
        longitude:
          position: [2, 96]
          font_size: 0.3
          color: [255, 255, 255]
        satellites_visible:
          position: [2, 88]
          font_size: 0.4
          color: [255, 255, 255]
        hdop:
          position: [2, 84]
          font_size: 0.4
          color: [255, 255, 255]
        
        # System status
        voltage:
          position: [2, 12]
          font_size: 0.4
          color: [255, 255, 255]
        arm_status:
          position: [2, 16]
          font_size: 0.5
          color: [255, 255, 255]
        flight_mode:
          position: [45, 10]
          font_size: 0.5
          color: [0, 0, 255]               # BGR: Blue
          alignment: center
    
    # === Tracker Status ===
    tracker_status:
      enabled: true
      position: [75, 92]
      font_size: 0.4
      color: [255, 255, 0]                 # BGR: Cyan
    
    # === Follower Status ===
    follower_status:
      enabled: true
      position: [75, 96]
      font_size: 0.4
      color: [255, 255, 0]                 # BGR: Cyan

# ==============================================================================
# DEBUGGING & LOGGING
# ==============================================================================
Debugging:
  # üêõ Debug and logging configuration
  ENABLE_DEBUGGING: true
  LOG_FILE_PATH: logs/tracking_log.txt
  LOG_LEVEL: INFO                          # DEBUG, INFO, WARNING, ERROR
  SAVE_DEBUG_FRAMES: false                 # Save frames for analysis
  DEBUG_FRAME_PATH: debug_frames/          # Debug frame storage

# ==============================================================================
# DEPRECATED PARAMETERS
# ==============================================================================
# ‚ö†Ô∏è These parameters are kept for backward compatibility but should not be used
# in new deployments. They will be removed in future versions.
#
# CSI_WIDTH/HEIGHT/FRAMERATE ‚Üí Use CAPTURE_WIDTH/HEIGHT/FPS in VideoSource
# ESTIMATOR_ENABLED ‚Üí Use USE_ESTIMATOR in Estimator section
# DEFAULT_FPS in FrameEstimation ‚Üí Use DEFAULT_FPS in VideoSource
# ==============================================================================