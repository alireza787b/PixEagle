[VideoSource]
; Video Source Configuration
; Options for VIDEO_SOURCE_TYPE: VIDEO_FILE, USB_CAMERA, RTSP_STREAM, UDP_STREAM, HTTP_STREAM, CSI_CAMERA
VIDEO_SOURCE_TYPE = USB_CAMERA

; For VIDEO_FILE, specify the path to the video file
VIDEO_FILE_PATH = resources/test7.mp4

; For USB_CAMERA, specify the camera index (0 for default webcam)
CAMERA_INDEX = 1

; For RTSP_STREAM, specify the RTSP URL
RTSP_URL = rtsp://172.21.144.1:8554

; For UDP_STREAM, specify the UDP URL
UDP_URL = udp://172.21.144.1:5000

; For HTTP_STREAM, specify the HTTP URL
HTTP_URL = http://172.21.144.1:8100

; CSI Camera Sensor ID (typically 0 for first camera)
CSI_SENSOR_ID = 0

[Camera]
; General Camera Parameters
; Number of frames to store in memory
STORE_LAST_FRAMES = 100

; Default frames per second for streaming and recording
DEFAULT_FPS = 30

; Camera Resolution & Frame Rate
; Options:
; - Low Quality: 640x480 @ 30fps
; - Medium Quality: 1280x720 @ 30fps
; - High Quality: 1920x1080 @ 30fps
; - Max Quality: 4608x2592 @ 14fps
CSI_WIDTH = 1280
CSI_HEIGHT = 720
CSI_FRAMERATE = 30

; Image Orientation (Flip Method)
; 0 - None (default), 1 - Rotate 90° CW, 2 - Upside Down, 3 - Rotate 90° CCW, etc.
CSI_FLIP_METHOD = 0

[Telemetry]
; Telemetry and Streaming Configuration
ENABLE_TELEMETRY = true
TELEMETRY_SEND_RATE = 2  ; Hz
TELEMETRY_FLASK_ENDPOINT = /telemetry

ENABLE_UDP_STREAM = false
UDP_HOST = 127.0.0.1
UDP_PORT = 5550

WEBSOCK_HOST = 127.0.0.1
WEBSOCK_PORT = 5551

ENABLE_FOLLOWER_TELEMETRY = true

[Streaming]
ENABLE_STREAMING = true
HTTP_STREAM_HOST = 0.0.0.0
HTTP_STREAM_PORT = 5077
STREAM_WIDTH = 640
STREAM_HEIGHT = 480
STREAM_QUALITY = 100  ; JPEG quality 0-100
STREAM_FPS = 30
STREAM_PROCESSED_OSD = true

[PX4]
; PX4 MAVSDK Configuration
EXTERNAL_MAVSDK_SERVER = true
SYSTEM_ADDRESS = udp://172.21.148.30:14540

[FrameEstimation]
; Frame and Estimation Configuration
FRAME_TITLE = Video
DEFAULT_FPS = 30  ; Default frame rate (FPS)
STORE_LAST_FRAMES = 5  ; Number of recent frames to store
USE_ESTIMATOR = false
ESTIMATOR_HISTORY_LENGTH = 5
SHOW_VIDEO_WINDOW = false

[Segmentation]
; Segmentation Configuration
; Options for SEGMENTATION_ALGORITHMS: GrabCut, Watershed, yolov8s-seg, yolov8n-oiv7, yolov8s-obb
SEGMENTATION_ALGORITHMS = GrabCut,Watershed,yolov8s-seg,yolov8n-oiv7,yolov8s-obb
DEFAULT_SEGMENTATION_ALGORITHM = yolo/yolov8n-oiv7
USE_SEGMENTATION_FOR_TRACKING = true

[Detector]
; Detector Configuration
USE_DETECTOR = true
AUTO_REDETECT = true
DETECTION_ALGORITHM = TemplateMatching
TEMPLATE_MATCHING_METHOD = TM_CCOEFF_NORMED
DEFAULT_FEATURE_EXTRACTION_ALGORITHM = ORB
MIN_MATCH_COUNT = 10
ORB_FLENN_TRESH = 0.8
ORB_FEATURES = 2000
FLANN_INDEX_LSH = 6
FLANN_TABLE_NUMBER = 6
FLANN_KEY_SIZE = 12
FLANN_MULTI_PROBE_LEVEL = 1
; FLANN_SEARCH_PARAMS is a JSON string
FLANN_SEARCH_PARAMS = {"checks": 50}

[Tracking]
; Tracking Configuration
DEFAULT_TRACKING_ALGORITHM = CSRT
TRACKING_RECTANGLE_COLOR = (255, 0, 0)
CENTER_CIRCLE_COLOR = (0, 255, 0)
CENTER_HISTORY_LENGTH = 10
PARTICLE_FILTER_NUM_PARTICLES = 200
PARTICLE_FILTER_SIMILARITY_MEASURE = MSE_color
PARTICLE_FILTER_SIGMA = 5
PARTICLE_FILTER_SIGMA_MOVE_NEAR = 15
PARTICLE_FILTER_SIGMA_MOVE_FAR = 30
PARTICLE_FILTER_SIGMA_RATIO = 0.5

[Follower]
; Follower Configuration
USE_MAVLINK2REST = true
FOLLOWER_DATA_REFRESH_RATE = 5
ROI_SELECTION_MODE = MANUAL
SHOW_TRACKING_WINDOW = true
DISPLAY_DEVIATIONS = false
TRACKED_BBOX_STYLE = fancy

; Colors
FOLLOWER_ACTIVE_COLOR = (0, 0, 255)
FOLLOWER_INACTIVE_COLOR = (0, 255, 255)

; Line properties
BBOX_LINE_THICKNESS = 2
EXTENDED_LINE_THICKNESS = 2

; Sizes
CORNER_DOT_RADIUS = 4
CROSSHAIR_ARM_LENGTH = 20
BBOX_CORNER_ARM_LENGTH = 20

; Opacity (0-255)
OVERLAY_OPACITY = 128

; Follower Mode
; Options: ground_view, constant_distance, constant_position, chase_follower
FOLLOWER_MODE = constant_distance
ENABLE_ALTITUDE_CONTROL = true
TARGET_POSITION_MODE = center

[YawControl]
; Yaw Control Parameters only for front view target follower
ENABLE_YAW_CONTROL = false
YAW_CONTROL_THRESHOLD = 0.3
YAW_LATERAL_BLEND_FACTOR = 0.5
YAW_DEAD_ZONE = 0.2

[VerticalErrorRecalculation]
; Vertical Error Recalculation Parameters
VERTICAL_RECALC_DELAY = 0.1
YAW_PITCH_SYNC_FACTOR = 0.5

[Gimbal]
ENABLE_GIMBAL_PRIORITY = true

[AdaptiveControl]
ADAPTIVE_YAW_CONTROL = false

[ChaseFollower]
; Chase Follower Rate Limits Configuration
MAX_ROLL_RATE = 20.0
MAX_PITCH_RATE = 10.0
MAX_YAW_RATE = 10.0
MAX_THRUST = 1.0
MIN_THRUST = 0.3
MIN_GROUND_SPEED = 0
MAX_GROUND_SPEED = 100
TARGET_SPEED = 60
MAX_BANK_ANGLE = 20
YAW_ERROR_CHECK_ENABLED = true
YAW_ERROR_THRESHOLD = 20
ALTITUDE_FAILSAFE_ENABLED = false

[PID]
; Control and PID parameters
; PID_GAINS is a complex data structure, encoded as JSON
PID_GAINS = {
    "x": {"p": 4.5, "i": 0.1, "d": 1.5},
    "y": {"p": 4.5, "i": 0.1, "d": 1.5},
    "z": {"p": 2, "i": 0.03, "d": 0.05},
    "roll_rate": {"p": 1, "i": 0.1, "d": 0.2},
    "pitch_rate": {"p": 10, "i": 0.1, "d": 0.2},
    "yaw_rate": {"p": 10, "i": 0.2, "d": 0.2},
    "thrust": {"p": 0.1, "i": 3, "d": 1}
}
PROPORTIONAL_ON_MEASUREMENT = false
ENABLE_ANTI_WINDUP = true
ANTI_WINDUP_BACK_CALC_COEFF = 0.1

[VelocityDescent]
; Velocity and descent limits
; VELOCITY_LIMITS is a JSON string
VELOCITY_LIMITS = {"x": 10.0, "y": 10.0, "z": 5.0}
ENABLE_DESCEND_TO_TARGET = false
MIN_DESCENT_HEIGHT = 40
MAX_CLIMB_HEIGHT = 10000
MAX_RATE_OF_DESCENT = 2
MAX_YAW_RATE = 10  ; Maximum yaw rate in degrees per second

DESIRE_AIM = (0, 0)
IS_CAMERA_GIMBALED = false
BASE_ADJUSTMENT_FACTOR_X = 0.1
BASE_ADJUSTMENT_FACTOR_Y = 0.1
ALTITUDE_FACTOR = 0.005

[GainScheduling]
; Gain scheduling configuration
; ALTITUDE_GAIN_SCHEDULE is a JSON string
ALTITUDE_GAIN_SCHEDULE = {
    "(0, 20)": {
        "x": {"p": 5.5, "i": 0.2, "d": 0.4},
        "y": {"p": 5.5, "i": 0.2, "d": 0.4},
        "z": {"p": 1, "i": 0.01, "d": 0.1}
    },
    "(20, 50)": {
        "x": {"p": 6, "i": 0.25, "d": 0.5},
        "y": {"p": 6, "i": 0.25, "d": 0.5},
        "z": {"p": 1, "i": 0.015, "d": 0.15}
    },
    "(50, 100)": {
        "x": {"p": 6.5, "i": 0.3, "d": 0.6},
        "y": {"p": 6.5, "i": 0.3, "d": 0.6},
        "z": {"p": 1, "i": 0.02, "d": 0.2}
    },
    "(100, 150)": {
        "x": {"p": 6, "i": 0.3, "d": 1.0},
        "y": {"p": 6, "i": 0.3, "d": 1.0},
        "z": {"p": 1, "i": 0.01, "d": 0.01}
    },
    "(150, 200)": {
        "x": {"p": 5.5, "i": 0.25, "d": 0.8},
        "y": {"p": 5.5, "i": 0.25, "d": 0.8},
        "z": {"p": 1, "i": 0.01, "d": 0.05}
    }
}
ENABLE_GAIN_SCHEDULING = false
GAIN_SCHEDULING_PARAMETER = current_altitude

[Setpoint]
; Camera and setpoint configurations
CAMERA_YAW_OFFSET = 0
SETPOINT_PUBLISH_RATE_S = 0.1
ENABLE_SETPOINT_DEBUGGING = false

[Debugging]
; Debugging and Logging
ENABLE_DEBUGGING = true
LOG_FILE_PATH = logs/tracking_log.txt

[GStreamer]
; GStreamer Configuration
ENABLE_GSTREAMER_STREAM = false
GSTREAMER_HOST = 127.0.0.1
GSTREAMER_PORT = 2000
GSTREAMER_BITRATE = 2000
GSTREAMER_WIDTH = 1280
GSTREAMER_HEIGHT = 720
GSTREAMER_FRAMERATE = 15
GSTREAMER_BUFFER_SIZE = 50000000
GSTREAMER_SPEED_PRESET = ultrafast
GSTREAMER_KEY_INT_MAX = 30
GSTREAMER_TUNE = zerolatency
GSTREAMER_CONTRAST = 5.0
GSTREAMER_BRIGHTNESS = 10
GSTREAMER_SATURATION = 5

[MAVLink]
; MAVLink Configuration
mavlink_enabled = true
mavlink_host = 127.0.0.1
mavlink_port = 8088
mavlink_polling_interval = 0.5

; Data points to extract from the MAVLink JSON response
; Each key corresponds to a data field that will be displayed on the OSD
; mavlink_data_points is a JSON string
mavlink_data_points = {
    "latitude": "/vehicles/1/components/1/messages/GLOBAL_POSITION_INT/message/lat",
    "longitude": "/vehicles/1/components/1/messages/GLOBAL_POSITION_INT/message/lon",
    "altitude_msl": "/vehicles/1/components/1/messages/ALTITUDE/message/altitude_amsl",
    "altitude_agl": "/vehicles/1/components/1/messages/ALTITUDE/message/altitude_relative",
    "voltage": "/vehicles/1/components/1/messages/SYS_STATUS/message/voltage_battery",
    "airspeed": "/vehicles/1/components/1/messages/VFR_HUD/message/airspeed",
    "throttle": "/vehicles/1/components/1/messages/VFR_HUD/message/throttle",
    "groundspeed": "/vehicles/1/components/1/messages/VFR_HUD/message/groundspeed",
    "climb": "/vehicles/1/components/1/messages/VFR_HUD/message/climb",
    "vn": "/vehicles/1/components/1/messages/LOCAL_POSITION_NED/message/vx",
    "ve": "/vehicles/1/components/1/messages/LOCAL_POSITION_NED/message/vy",
    "vd": "/vehicles/1/components/1/messages/LOCAL_POSITION_NED/message/vz",
    "flight_path_angle": null,
    "roll": "/vehicles/1/components/1/messages/ATTITUDE/message/roll",
    "pitch": "/vehicles/1/components/1/messages/ATTITUDE/message/pitch",
    "heading": "/vehicles/1/components/1/messages/VFR_HUD/message/heading",
    "vdop": "/vehicles/1/components/1/messages/GPS_RAW_INT/message/vdop",
    "hdop": "/vehicles/1/components/1/messages/GPS_RAW_INT/message/hdop",
    "satellites_visible": "/vehicles/1/components/1/messages/GPS_RAW_INT/message/satellites_visible",
    "flight_mode": "/vehicles/1/components/1/messages/HEARTBEAT/message/custom_mode",
    "arm_status": "/vehicles/1/components/1/messages/HEARTBEAT/message/base_mode"
}

[OSD]
; OSD Configuration
OSD_ENABLED = true

; OSD_CONFIG is a complex data structure, encoded as JSON
OSD_CONFIG = {
    "name": {
        "enabled": true,
        "text": "PixEagle",
        "position": [3, 5],
        "color": [255, 255, 255],
        "font_size": 0.7
    },
    "datetime": {
        "enabled": true,
        "position": [98, 5],
        "color": [255, 255, 255],
        "font_size": 0.6,
        "alignment": "right"
    },
    "crosshair": {
        "enabled": true,
        "color": [0, 255, 0],
        "thickness": 2,
        "length": 15
    },
    "attitude_indicator": {
        "enabled": true,
        "position": [50, 50],
        "size": [70, 70],
        "horizon_color": [255, 255, 255],
        "grid_color": [200, 200, 200],
        "thickness": 2
    },
    "mavlink_data": {
        "enabled": true,
        "fields": {
            "heading": {
                "position": [45, 30],
                "font_size": 0.5,
                "color": [255, 255, 255]
            },
            "airspeed": {
                "position": [10, 45],
                "font_size": 0.4,
                "color": [255, 255, 255]
            },
            "groundspeed": {
                "position": [10, 55],
                "font_size": 0.4,
                "color": [255, 255, 255]
            },
            "throttle": {
                "position": [10, 65],
                "font_size": 0.3,
                "color": [255, 255, 255]
            },
            "altitude_msl": {
                "position": [65, 45],
                "font_size": 0.4,
                "color": [255, 255, 255]
            },
            "altitude_agl": {
                "position": [65, 55],
                "font_size": 0.4,
                "color": [255, 255, 255]
            },
            "flight_path_angle": {
                "position": [65, 65],
                "font_size": 0.4,
                "color": [255, 255, 255]
            },
            "roll": {
                "position": [45, 75],
                "font_size": 0.5,
                "color": [255, 255, 255]
            },
            "pitch": {
                "position": [45, 80],
                "font_size": 0.5,
                "color": [255, 255, 255]
            },
            "latitude": {
                "position": [2, 92],
                "font_size": 0.3,
                "color": [255, 255, 255]
            },
            "longitude": {
                "position": [2, 96],
                "font_size": 0.3,
                "color": [255, 255, 255]
            },
            "satellites_visible": {
                "position": [2, 88],
                "font_size": 0.4,
                "color": [255, 255, 255]
            },
            "hdop": {
                "position": [2, 84],
                "font_size": 0.4,
                "color": [255, 255, 255]
            },
            "voltage": {
                "position": [2, 12],
                "font_size": 0.4,
                "color": [255, 255, 255]
            },
            "arm_status": {
                "position": [2, 16],
                "font_size": 0.5,
                "color": [255, 255, 255]
            },
            "flight_mode": {
                "position": [45, 10],
                "font_size": 0.5,
                "color": [0, 0, 255],
                "alignment": "center"
            }
        }
    },
    "tracker_status": {
        "enabled": true,
        "position": [75, 92],
        "font_size": 0.4,
        "color": [255, 255, 0]
    },
    "follower_status": {
        "enabled": true,
        "position": [75, 96],
        "font_size": 0.4,
        "color": [255, 255, 0]
    }
}
